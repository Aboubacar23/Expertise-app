{% extends 'base.html.twig' %}

{% block title %}Hello HomeController!
{% endblock %}

{% block body %}
	<div class="row" style="display: inline-block;">
		<div class="tile_count">
			<div class="col-md-3 col-sm-4  tile_stats_count">
				<span class="count_top"><i class="fa fa-user"></i>Total Utilisateurs</span>
				<div class="count">{{ admin }}</div>
				<span class="count_bottom"><i class="green"></i>Système</span>
			</div>
			<div class="col-md-3 col-sm-4  tile_stats_count">
				<span class="count_top"><i class="fa fa-user"></i>Total Client</span>
				<div class="count">{{client}}</div>
				<span class="count_bottom"><i class="green"><i class="fa fa-sort-asc"></i></i>
				</span>
			</div>
			<div class="col-md-3 col-sm-4  tile_stats_count">
				<span class="count_top"><i class="fa fa-folder"></i>Total Projet</span>
				<div class="count green">{{affaire}}</div>
				<span class="count_bottom"><i class="red"><i class="fa fa-sort-asc"></i>{{ encoursPourc | number_format(2) }} %</i>En cours</span>
			</div>
			<div class="col-md-3 col-sm-4  tile_stats_count">
				<span class="count_top"><i class="fa fa-list"></i>Rapports</span>
				<div class="count">{{nombre}}</div>
				<span class="count_bottom"><i class="red"><i class="fa fa-sort-desc"></i></i>
				</span>
			</div>
		</div>
	</div>
	<div class="row">
		<div class="col-md-6 col-sm-6 ">
			<div class="x_panel tile fixed_height_320">
				<div class="x_title">
					<h2>Affaires</h2>
					<ul class="nav navbar-right panel_toolbox"></ul>
					<div class="clearfix"></div>
				</div>
				<div class="x_content">
					<div class="widget_summary">
						<div class="w_left w_25">
							<span>Total</span>
						</div>
						<div class="w_center w_55">
							<div class="progress">
								<div class="progress-bar bg-green" role="progressbar" aria-valuenow="10" aria-valuemin="0" aria-valuemax="100" style="width: 100%;">
									<span class="sr-only">60% Complete</span>
								</div>
							</div>
						</div>
						<div class="w_right w_20">
							<span>100 % ({{var_par}})</span>
						</div>
						<div class="clearfix"></div>
					</div>

					<div class="widget_summary">
						<div class="w_left w_25">
							<span>Encours</span>
						</div>
						<div class="w_center w_55">
							<div class="progress">
								<div class="progress-bar bg-green" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: {{encoursPourc}}%;"></div>
							</div>
						</div>
						<div class="w_right w_20">
							<span>{{encoursPourc | number_format(2)}} % ({{encours}})</span>
						</div>
						<div class="clearfix"></div>
					</div>
					<div class="widget_summary">
						<div class="w_left w_25">
							<span>Terminer</span>
						</div>
						<div class="w_center w_55">
							<div class="progress">
								<div class="progress-bar bg-green" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: {{terminerPourc}}%;"></div>
							</div>
						</div>
						<div class="w_right w_20">
							<span>{{terminerPourc | number_format(2)}} % ({{terminer}})</span>
						</div>
						<div class="clearfix"></div>
					</div>
					<div class="widget_summary">
						<div class="w_left w_25">
							<span>Fermer</span>
						</div>
						<div class="w_center w_55">
							<div class="progress">
								<div class="progress-bar bg-green" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: {{bloque}}%;">
								</div>
							</div>
						</div>
						<div class="w_right w_20">
							<span>{{bloque | number_format(2)}} % ({{bloqueVal}})</span>
						</div>
						<div class="clearfix"></div>
					</div>
				</div>
			</div>
		</div>
		<div class="col-md-6 col-sm-6 ">
		  <div class="x_panel">
			<div class="x_title">
			  <h2>Étape à suivre <small>pour une expertise</small></h2>
			  <div class="clearfix"></div>
			</div>
			<div class="x_content">
			  <div class="">
				<ul class="to_do">
				   <li>
					  <p><input type="checkbox" class="flat"> Créer un Client</p>
				  </li>
				  <li>
					<p><input type="checkbox" class="flat"> Créer un type de machine</p>
				  </li>
				  <li>
					<p><input type="checkbox" class="flat"> Créer une machine</p>
				  </li>
				  <li>
					<p><input type="checkbox" class="flat"> Créer une affaire</p>
				  </li>
				  <li>
					<p><input type="checkbox" class="flat"> Déclencher la Revue d'Enclenchement</p>
				  </li>
				  <li>
					<p><input type="checkbox" class="flat"> Créer de parametre sur une affaire</p>
				  </li>
				</ul>
			  </div>
			</div>
		  </div>
		</div>
	</div>
	<br>
	<div class="row">
		<div class="col-md-12 col-sm-12 ">
			<div class="dashboard_graph">
				<div class="row x_title">
					<div class="col-md-6">
						<h3>Tableau de Suivi d'expertise<small></small>
						</h3>
					</div>
				</div>
				<div class="col-md-12 col-sm-12 ">
					<table class="table table-striped table-bordered" style="width:100%">
						<thead class="table-secondary mt-2" cellspacing="0">
							<tr>
								<th width="2">N°</th>
								<th>N° Affaire JE</th>
								{# <th>Nom Client</th>
								<th>Type Machine</th>
								<th>Machine</th>#}
								<th>Suivi Par</th>
								<th>Reunion Enc</th>
								<th>Date d'arrivée</th>
								<th>Expertise Electrique Avant lavage</th>
								<th>Expertise Méca</th>
								<th>Expertise Electrique Après lavage</th>
								<th>Validation Rapport Expertise</th>
								<th>Remontage</th>
								<th>Fin Essais Finaux</th>
								<th>Validation Rapport Final</th>
								<th>Date livraison</th>
							</tr>
						</thead>
						<tbody>
							{% set i = 0 %}
							{% for affaire in affaires %}
								{% for item in affaire.parametres %}
									{% set i = i + 1 %}
									<tr>
										<td>{{i}}</td>
										<td>{{ item.affaire.numAffaire }}</td>
										{#<td>{{ item.affaire.client }}</td>
										<td>{{ item.type }}</td>
										<td>{{ item.machine }}</td>#}
										<td>{{ item.affaire.suiviPar }}</td>
										{% if item.affaire.revueEnclenchement %}
											<td class="text-center text-success">ok</td>
										{% else %}
											<td class="text-center text-danger">Non OK</td>
										{% endif %}
										<td>{{ item.dateArrivee ? item.dateArrivee|date('Y-m-d') : '' }}</td>
										{% if item.expertiseElectiqueAvantLavage == 1 %}
											<td class="text-center">
												<i class="fa fa-circle fa-10x green"></i>
											</td>
										{% elseif item.expertiseElectiqueAvantLavage == 0 %}
											<td class="text-center">
												<i class="fa fa-circle fa-10x red"></i>
											</td>
										{% endif %}
										{% if item.expertiseMecanique == 1 %}
											<td class="text-center">
												<i class="fa fa-circle fa-10x green"></i>
											</td>
										{% elseif item.expertiseMecanique == 0 %}
											<td class="text-center">
												<i class="fa fa-circle fa-10x red"></i>
											</td>
										{% endif %}
										{% if item.expertiseElectiqueApresLavage == 1 %}
											<td class="text-center">
												<i class="fa fa-circle fa-10x green"></i>
											</td>
										{% elseif item.expertiseElectiqueApresLavage == 0 %}
											<td class="text-center">
												<i class="fa fa-circle fa-10x red"></i>
											</td>
										{% endif %}
										{% if item.statut == 1 %}
											<td class="text-center text-success">ok</td>
										{% elseif item.statut == 0 %}
											<td class="text-center text-danger">Non OK</td>
										{% endif %}

										{% if item.remontage == 1 %}
											<td class="text-center">
												<i class="fa fa-circle fa-10x green"></i>
											</td>
										{% elseif item.remontage == 0 %}
											<td class="text-center">
												<i class="fa fa-circle fa-10x red"></i>
											</td>
										{% endif %}
										{% if item.essaisFinaux == 1 %}
											<td class="text-center">
												<i class="fa fa-circle fa-10x green"></i>
											</td>
										{% else %}
											<td class="text-center">
												<i class="fa fa-circle fa-10x red"></i>
											</td>
										{% endif %}

										{% if item.essaisFinaux == 1 and item.expertiseElectiqueApresLavage == 1 and item.expertiseMecanique == 1 and item.expertiseElectiqueAvantLavage == 1 %}
											<td class="text-center">
												<i class="fa fa-circle fa-10x green"></i>
											</td>
										{% else %}
											<td class="text-center">
												<i class="fa fa-circle fa-10x red"></i>
											</td>
										{% endif %}

										<td>{{ item.affaire.dateLivraison ? item.affaire.dateLivraison|date('Y-m-d') : '' }}</td>
									</tr>
								{% endfor %}
							{% else %}
								<tr>
									<td colspan="13">Pas d'affaire dans le système</td>
								</tr>
							{% endfor %}
						</tbody>
					</table>
				</div>
				<div class="clearfix"></div>
			</div>
		</div>
	</div>
{% endblock %}
